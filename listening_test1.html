<script type="text/javascript">
    var gk_isXlsx = false;
    var gk_xlsxFileLookup = {};
    var gk_fileData = {};
    function filledCell(cell) {
        return cell !== '' && cell != null;
    }
    function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                    row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                    headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
    }
</script>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Listening Tests | IELTS WITH UMAR</title>
    <link rel="icon" href="IELTS WITH UMAR LOGO ORIGINAL.jpg" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            line-height: 1.4;
            font-size: 16px;
            padding-bottom: 90px;
            /* nav-row height (80px) + some extra spacing */
        }

        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
        }

        .ielts-logo {
            display: none;
        }

        .test-info {
            display: flex;
            align-items: center;
            gap: 30px;
            font-size: 14px;
            color: #333;
        }

        .audio-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .audio-icon {
            width: 16px;
            height: 16px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>') no-repeat center;
        }

        .header-icons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .telegram-link {
            color: #0088cc;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .telegram-link:hover {
            text-decoration: underline;
        }

        .telegram-link::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: currentColor;
            -webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }

        #volume-slider {
            -webkit-appearance: none;
            width: 80px;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
        }

        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
        }

        #volume-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            border: none;
        }

        .icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0.7;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon:hover {
            opacity: 1;
        }

        #play-pause-btn {
            background: none;
            border: none;
            padding: 0;
        }

        .main-container {
            margin-top: 60px;
            display: flex;
            background: #ffffff;
            padding-bottom: 100px;
            /* Space for bottom nav */
        }

        .main-container.results-mode {
            display: flex;
            flex-direction: row;
        }

        /* Left Panel */
        .left-panel {
            width: 100%;
            padding: 20px;
            transition: width 0.4s ease;
        }

        .main-container.results-mode .left-panel {
            width: 50%;
            overflow-y: auto;
            height: calc(100vh - 195px);
        }

        /* Right Panel */
        .right-panel {
            display: none;
            width: 50%;
            padding: 20px;
            position: relative;
            border-left: 1px solid #e0e0e0;
            overflow-y: auto;
            height: calc(100vh - 195px);
        }

        #transcription-container h2 {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #transcription-text {
            white-space: pre-wrap;
            font-family: inherit;
            font-size: 15px;
            line-height: 1.7;
        }

        .transcription-instruction {
            display: block;
            margin: 1em 0;
            font-style: italic;
            color: #444;
        }

        .main-container.results-mode .right-panel {
            display: block;
            width: 50%;
            border-left: 1px solid #e0e0e0;
            border-top: none;
            height: calc(100vh - 195px);
            overflow-y: auto;
        }

        .help-button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        .correct-answer-text {
            color: #28a745;
            font-weight: bold;
            margin-left: 10px;
        }

        .help-button:hover {
            background: #357abd;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .people-section {
            margin-bottom: 30px;
        }

        .people-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
        }

        .people-table th {
            text-align: left;
            padding: 10px;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .people-table td {
            padding: 8px 10px;
            border: 1px solid #ddd;
        }

        .person-name {
            font-size: 16px;
        }

        .question-number {
            background: white;
            border: 1px solid #4a90e2;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 14px;
            color: #4a90e2;
            min-width: 30px;
            text-align: center;
        }

        .assigned-responsibility {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 14px;
            border: 1px solid #ddd;
        }

        .responsibilities-section {
            margin-bottom: 30px;
        }

        .responsibility-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .responsibility-item {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .responsibility-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .responsibility-item.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }

        .questions-section {
            margin-bottom: 20px;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .instruction {
            margin-bottom: 20px;
            font-size: 16px;
            color: #666;
        }

        .centered-title {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        /* Map Styles */
        .map-container {
            position: relative;
            margin: 20px auto;
            width: 100%;
            max-width: 600px;
            display: block;
        }

        .map-container img {
            width: 100%;
            display: block;
        }

        .map-drop-zone {
            position: absolute;
            width: 13%;
            height: 15%;
            border: 2px dashed #999;
            background-color: rgba(255, 255, 255, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #555;
            border-radius: 4px;
            padding: 2px;
        }

        .map-drop-zone:hover {
            background-color: rgba(230, 244, 255, 0.7);
            border-color: #4a90e2;
        }

        .map-drop-zone .drag-item {
            font-size: 14px;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2px;
        }

        .map-options-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        .map-options-list .drag-item {
            width: calc(25% - 10px);
            text-align: center;
        }

        /* Navigation Arrows */
        .nav-arrows {
            position: fixed;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 5px;
            z-index: 101;
        }

        .nav-arrow {
            width: 50px;
            height: 50px;
            background: #333;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: bold;
        }

        .nav-arrow:hover {
            background: #555;
        }

        .nav-arrow:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Bottom Navigation - Exact Match */
        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;

            padding: 0;
            display: flex;
            align-items: center;
            height: 80px;
            z-index: 100;

            /* Allow horizontal scrolling on smaller screens */
            overflow-x: auto;
            overflow-y: hidden;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        .footer__questionWrapper___1tZ46 {
            display: flex;
            align-items: center;
            margin-right: 20px;
            flex-shrink: 0;
        }


        .footer__questionNo___3WNct {
            background: none;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .footer__questionNo___3WNct:hover {
            background-color: #f8f9fa;
        }

        .section-prefix {
            font-size: 16px;
        }

        .sectionNr {
            font-size: 16px;
            font-weight: bold;
        }

        .attemptedCount {
            font-size: 14px;
            color: #666;
            margin-left: 5px;
            font-weight: 400;
            /* Normal weight */
        }

        @media (max-width: 1024px) {
            .attemptedCount {
                display: none;
            }
        }

        .footer__questionWrapper___1tZ46.selected .attemptedCount {
            display: none;
        }

        .footer__subquestionWrapper___9GgoP {
            display: none;
            gap: 2px;
            margin-left: 10px;
        }

        .footer__questionWrapper___1tZ46.selected .footer__subquestionWrapper___9GgoP {
            display: flex;
        }

        .subQuestion {
            width: 32px;
            height: 32px;
            border: 1px solid #ccc;
            background: white;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-radius: 2px;
        }

        .subQuestion.answered {
            background-color: #e9ecef;
            border-color: #ddd;
        }

        .subQuestion.correct {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .subQuestion.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .subQuestion:hover {
            background-color: #f0f0f0;
            border-color: #999;
        }

        .subQuestion.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .subQuestion.completed {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .footer__deliverButton___3FM07 {
            margin-left: auto;
            margin-right: 20px;
            background-color: #f0f0f0;
            color: #333;
            border: 1px solid #ccc;
            padding: 12px 20px;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s, border-color 0.2s;
            min-width: 170px;
            justify-content: center;
        }

        .footer__deliverButton___3FM07:hover {
            background-color: #e0e0e0;
            border-color: #bbb;
        }

        .footer__deliverButton___3FM07:disabled {
            background: #e9ecef;
            color: #6c757d;
            cursor: not-allowed;
            border-color: #ddd;
        }

        .fa-check::before {
            content: "✓";
        }

        .hidden {
            display: none;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: none;
            min-width: 140px;
        }

        .context-menu-item {
            padding: 12px 16px;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .context-menu-item:hover {
            background-color: #f8f9fa;
        }

        .context-menu-item:last-child {
            border-bottom: none;
        }

        .highlight {
            background-color: #ffff00;
        }

        .comment-highlight {
            background-color: #90EE90;
            position: relative;
            cursor: help;
        }

        .comment-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .comment-highlight:hover .comment-tooltip {
            opacity: 1;
        }

        .question {
            margin-bottom: 40px;
        }

        .question p {
            margin-bottom: 10px;
        }

        .question ul,
        .question .people-table {
            margin-top: 0;
        }

        .question-prompt {
            margin-bottom: 20px;
        }

        .question ul {
            list-style: none;
            padding-left: 0;
        }

        .question ul li {
            margin-bottom: 5px;
        }

        .answer-input {
            border: 1px solid #888;
            border-radius: 4px;
            background-color: #fff;
            padding: 2px 5px;
            font-size: 16px;
            text-align: center;
            margin-right: 4px;
            margin-left: 4px;
            width: 100px;
            max-width: 120px;
            min-width: 80px;
            word-break: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            height: auto;
            min-height: 28px;
            line-height: 1.2;
            vertical-align: middle;
        }

        .answer-input::placeholder {
            color: #999;
            font-weight: bold;
            text-align: center;
        }

        .answer-input.correct {
            border-color: #28a745;
            background-color: #e9f7ef;
        }

        .answer-input.incorrect {
            border-color: #dc3545;
            background-color: #f8d7da;
            color: #721c24;
        }

        .answer-input {
            z-index: 10;
            position: relative;
            pointer-events: auto;
        }

        .drag-drop-container {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }

        .recommendations-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
            min-height: 200px;
        }

        .drag-item {
            background: white;
            border: 1px solid #ddd;
            padding: 6px 8px;
            border-radius: 4px;
            cursor: move;
            font-size: 14px;
            transition: all 0.2s;
            user-select: none;
            word-break: break-word;
            overflow-wrap: break-word;
            text-align: center;
            line-height: 1.2;
            max-width: 100%;
            box-sizing: border-box;
        }

        .drag-item:hover {
            background: #e9ecef;
        }

        .drag-item.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }

        .drop-zone {
            border: 1px dashed #ccc;
            border-radius: 4px;
            min-height: 40px;
            height: auto;
            max-width: 120px;
            min-width: 100px;
            transition: background-color 0.2s, border-color 0.2s;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            word-break: break-word;
            overflow-wrap: break-word;
            text-align: center;
            line-height: 1.2;
        }

        .drop-zone.drag-over {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }

        .drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }

        .drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }

        .drop-zone .drag-item {
            cursor: default;
        }

        .drag-item.selected {
            border-color: #4a90e2;
            box-shadow: 0 0 0 1px #4a90e2;
        }

        .questions-container {
            width: 50%;
        }

        audio {
            width: 100%;
            margin-bottom: 20px;
        }

        .part-header {
            background-color: #f1f2ec;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }

        .part-header p {
            margin: 0;
        }

        .question li.correct {
            color: #155724;
            font-weight: bold;
        }

        .question li.incorrect {
            color: #721c24;
        }

        .question li.correct::before {
            content: '✔ ';
            color: #28a745;
        }

        .question li.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }

        .example-box {
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .timer-container {
            display: none;
            /* Timer hidden */
            color: #333;
            font-size: 16px;
            font-weight: 500;
        }

        .timer-container .timer-tooltip {
            display: none;
        }

        .audio-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(40, 40, 40, 0.9);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }

        .audio-modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 500px;
            padding: 20px;
        }

        .audio-modal-content p {
            font-size: 16px;
            line-height: 1.5;
            color: #eee;
        }

        .audio-modal-icon {
            margin-bottom: 20px;
        }

        .modal-play-btn {
            background-color: #000;
            color: white;
            border: 1px solid white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }

        .modal-play-btn:hover {
            background-color: #333;
        }

        #goto-widget {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        #goto-input {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        #goto-btn {
            padding: 4px 10px;
            border: 1px solid #ccc;
            background-color: #f0f0f0;
            border-radius: 4px;
            cursor: pointer;
        }

        @keyframes flash {
            0% {
                background-color: #e6f4ff;
            }

            100% {
                background-color: transparent;
            }
        }

        .question.flash {
            animation: flash 1s ease-out;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 8px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ddd;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            font-size: 24px;
            color: #333;
        }

        .modal-close-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #888;
            line-height: 1;
        }

        .modal-close-btn:hover {
            color: #333;
        }

        #score-summary {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        #result-details table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        #result-details th,
        #result-details td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
            vertical-align: middle;
        }

        #result-details th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        #result-details td:nth-child(1) {
            font-weight: bold;
            text-align: center;
        }

        .result-correct {
            color: #28a745;
            font-weight: bold;
        }

        .result-incorrect {
            color: #dc3545;
            font-weight: bold;
        }

        .context-menu-icon {
            width: 16px;
            height: 16px;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }

        .matching-container {
            display: flex;
            justify-content: space-between;
            gap: 40px;
            margin-top: 20px;
            align-items: flex-start;
        }

        .matching-table {
            flex: 4;
            border-collapse: collapse;
        }

        .matching-table th,
        .matching-table td {
            border: 1px solid #ddd;
            padding: 6px 12px;
            text-align: left;
            vertical-align: middle;
        }

        .matching-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        .matching-table .drop-zone {
            min-height: 36px;
            height: auto;
            max-width: 120px;
            min-width: 100px;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            background-color: #fff;
            border: 1px dashed #ccc;
            border-radius: 4px;
            word-break: break-word;
            overflow-wrap: break-word;
            text-align: center;
            line-height: 1.2;
        }

        .matching-table .drop-zone .drag-item {
            width: 100%;
            max-width: 100%;
            text-align: center;
            padding: 4px 5px;
            font-size: 13px;
            line-height: 1.1;
            word-break: break-word;
            overflow-wrap: break-word;
            box-sizing: border-box;
        }

        .matching-options-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            flex: 1;
            background-color: transparent;
            padding: 0;
            border: none;
            min-height: 250px;
            min-width: 280px;
            /* ensure enough width for long option text to stay on one line */
        }

        .matching-options-list .drag-item {
            width: 100%;
        }

        .matching-question-item .drop-zone .placeholder {
            color: #999;
            font-weight: bold;
        }

        .option strong,
        .question ul li label strong {
            display: none;
        }

        /* Mobile selection toolbar */
        .mobile-selection-menu {
            position: absolute;
            background: #333;
            color: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            display: flex;
            gap: 8px;
            z-index: 3000;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
        }

        .mobile-selection-menu button {
            background: transparent;
            border: 1px solid #fff;
            color: #fff;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 14px;
        }

        .mobile-selection-menu.hidden {
            display: none;
        }

        /* === MCQ table styling for Questions 11-15 === */
        .mcq-table {
            width: 100%;
            border-collapse: collapse;
        }

        .mcq-table th,
        .mcq-table td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            vertical-align: middle;
            text-align: center;
        }

        .mcq-table th {
            background-color: #1e6de6;
            /* vibrant blue header like screenshot */
            color: #ffffff;
            font-weight: 600;
            text-align: center;
        }

        .mcq-table th:first-child {
            text-align: left;
        }

        .mcq-table tbody td:first-child {
            font-weight: 500;
            text-align: left;
        }

        .mcq-table tr:nth-child(even) td {
            background-color: #f8faff;
            /* subtle alternating row colour */
        }

        .mcq-table input[type="radio"] {
            transform: scale(1.1);
            cursor: pointer;
        }

        /* list of options (A, B, C) shown above the table */
        .mcq-options {
            list-style: none;
            padding-left: 0;
            margin: 10px 0;
        }

        .mcq-options li {
            margin-bottom: 4px;
            font-size: 16px;
        }

        /* Compact single-choice list */
        .single-choice-container {
            margin: 10px 0;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .single-choice label {
            display: block;
            margin-left: 20px;
            margin-top: 4px;
            font-size: 16px;
        }

        .aligned-form .question-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .aligned-form .question-label {
            width: 230px;
            padding-right: 10px;
        }

        /* Responsive adjustments for tablets */
        @media (max-width: 1024px) {
            .main-container {
                flex-direction: column;
            }

            .right-panel,
            .main-container.results-mode .right-panel {
                display: none;
            }

            .left-panel,
            .main-container.results-mode .left-panel {
                width: 100%;
                padding: 20px 10px;
                height: auto;
                /* Reset height for mobile */
            }

            .questions-container {
                width: 100%;
            }
        }

        .single-choice label.correct {
            color: #155724;
            font-weight: bold;
        }

        .single-choice label.correct::before {
            content: '✔ ';
            color: #28a745;
        }

        .single-choice label.incorrect {
            color: #721c24;
            text-decoration: line-through;
        }

        .single-choice label.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }

        .mcq-table tbody tr.correct {
            background-color: #d4edda !important;
            color: #155724;
            font-weight: bold;
        }

        .mcq-table tbody tr.incorrect {
            background-color: #f8d7da !important;
            text-decoration: line-through;
        }

        .mcq-table tbody tr.incorrect td {
            color: #721c24;
        }

        /* New Audio Player Styles */
        .audio-player-container {
            position: fixed;
            top: 65px;
            left: 50%;
            transform: translateX(-50%);
            width: 500px;
            max-width: 90%;
            height: 40px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            z-index: 99;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .main-container {
            margin-top: 115px;
        }

        .player-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .player-btn svg {
            width: 20px;
            height: 20px;
            fill: #333;
        }

        .progress-container {
            flex-grow: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #progress-bar {
            flex-grow: 1;
            -webkit-appearance: none;
            appearance: none;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 3px;
            cursor: pointer;
        }

        #progress-bar::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4a90e2;
            cursor: pointer;
        }

        #progress-bar::-moz-range-thumb {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4a90e2;
            cursor: pointer;
            border: none;
        }

        #current-time,
        #total-duration {
            font-size: 12px;
            color: #555;
            min-width: 35px;
            text-align: center;
        }

        .controls-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .volume-container {
            display: flex;
            align-items: center;
            position: relative;
        }

        #new-volume-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 60px;
            height: 3px;
            background: #ccc;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
            margin-left: 8px;
            display: block;
        }

        #new-volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #333;
        }

        #new-volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #333;
            border: none;
        }

        .speed-container {
            position: relative;
        }

        #speed-btn {
            font-size: 12px;
            font-weight: 600;
            color: #333;
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 4px 8px;
        }

        #speed-options {
            position: absolute;
            top: calc(100% + 5px);
            /* Position below the button with a small gap */
            right: 0;
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        #speed-options div {
            padding: 8px 15px;
            cursor: pointer;
        }

        #speed-options div:hover {
            background-color: #f0f0f0;
        }

        /* Flowchart styles */
        .flowchart-container {
            border: 1px solid #ccc;
            padding: 0 20px;
        }

        .flowchart-step {
            text-align: center;
            margin: 0;
            padding: 20px 0;
            border-top: 1px solid #ddd;
        }

        .flowchart-step:first-child {
            border-top: none;
            padding-top: 20px;
            margin-top: 0;
        }

        .flowchart-arrow {
            text-align: center;
            margin: 0;
            padding: 15px 0;
            font-size: 20px;
            color: #555;
            border-top: 1px solid #ddd;
        }

        .flowchart-split {
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            gap: 20px;
            border-top: 1px solid #ddd;
        }

        .flowchart-split-col {
            width: 48%;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .flowchart-split .flowchart-step {
            border-top: none;
            padding-top: 0;
            margin-top: 0;
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px 0;
        }

        .flowchart-split .flowchart-arrow {
            border-top: none;
            padding: 15px 0;
        }


        /* Responsive adjustments for tablets */
        @media (max-width: 1024px) {
            .main-container {
                flex-direction: column;
            }

            .right-panel,
            .main-container.results-mode .right-panel {
                display: none;
            }

            .left-panel,
            .main-container.results-mode .left-panel {
                width: 100%;
                padding: 20px 10px;
                height: auto;
                /* Reset height for mobile */
            }

            .questions-container {
                width: 100%;
            }

            /* Adjust input boxes for tablets */
            .answer-input {
                width: 90px;
                max-width: 110px;
                font-size: 15px;
            }

            .drop-zone {
                max-width: 110px;
                min-width: 90px;
            }

            .matching-table .drop-zone {
                max-width: 110px;
                min-width: 90px;
            }
        }

        /* Responsive adjustments for mobile phones */
        @media (max-width: 768px) {
            .answer-input {
                width: 80px;
                max-width: 100px;
                font-size: 14px;
                padding: 2px 4px;
            }

            .drop-zone {
                max-width: 100px;
                min-width: 80px;
                font-size: 14px;
            }

            .matching-table .drop-zone {
                max-width: 100px;
                min-width: 80px;
            }

            .drag-item {
                font-size: 13px;
                padding: 4px 6px;
            }

            .matching-table .drop-zone .drag-item {
                font-size: 12px;
            }

            /* Ensure drag-drop containers are more mobile-friendly */
            .drag-drop-container {
                flex-direction: column;
                gap: 15px;
            }

            .matching-container {
                flex-direction: column;
                gap: 20px;
            }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
            .answer-input {
                width: 70px;
                max-width: 90px;
                font-size: 13px;
            }

            .drop-zone {
                max-width: 90px;
                min-width: 70px;
            }

            .matching-table .drop-zone {
                max-width: 90px;
                min-width: 70px;
            }
        }


        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --passage-bg: #f8f9fa;
            --questions-bg: #ffffff;
            --border-color: #e0e0e0;
            --highlight-color: #90EE90;
            --header-bg: rgb(0, 175, 0);
            --header-text: #ffffff;
            --button-bg: #28a745;
            --button-hover: #218838;
            --correct-color: #28a745;
            --incorrect-color: #dc3545;
            --progress-complete: #28a745;
            --progress-incomplete: #bdbdbd;
            --timer-bg: #e6ffe6;
            --timer-text: #28a745;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.4;
            font-size: 16px;
            padding-bottom: 90px;
            padding-top: 70px;
            /* space for fixed header */
        }

        .header {
            background-color: var(--header-bg);
            color: var(--header-text);
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: 60px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .timer-container {
            background-color: var(--timer-bg);
            color: var(--timer-text);
            padding: 8px 15px;
            border-radius: 50px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .timer-controls {
            display: flex;
            gap: 8px;
        }

        .timer-controls button {
            background: none;
            border: none;
            color: var(--timer-text);
            cursor: pointer;
            font-size: 16px;
            padding: 4px;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .timer-controls button:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .container,
        .passage,
        .questions,
        .box,
        .input-field {
            background-color: var(--questions-bg);
            color: var(--text-color);
            border-color: var(--border-color);
        }

        .header {
            display: flex;
            justify-content: flex-start;
            /* or simply remove justify-content */
            align-items: center;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="timer-container">
            <i class="fas fa-clock" aria-hidden="true"></i>
            <span id="timer" class="timer-display">40:00</span>
            <div class="timer-controls">
                <button id="start-timer" title="Start"><i class="fas fa-play" aria-hidden="true"></i></button>
                <button id="pause-timer" title="Pause"><i class="fas fa-pause" aria-hidden="true"></i></button>
                <button id="reset-timer" title="Reset"><i class="fas fa-redo" aria-hidden="true"></i></button>
            </div>
        </div>
    </div>

    <div class="audio-player-container">
        <button id="play-pause-btn" class="player-btn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M8 5v14l11-7z" />
            </svg>
        </button>
        <div class="progress-container">
            <span id="current-time">0:00</span>
            <input type="range" id="progress-bar" value="0" step="1" style="width: 100%;">
            <span id="total-duration">0:00</span>
        </div>
        <div class="controls-container">
            <div class="volume-container">
                <button id="volume-btn" class="player-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                        <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                    </svg>
                </button>
                <input type="range" id="new-volume-slider" min="0" max="1" step="0.01" value="1">
            </div>
            <div class="speed-container">
                <button id="speed-btn" class="player-btn">1x</button>
                <div id="speed-options" class="hidden">
                    <div data-speed="0.5">0.5x</div>
                    <div data-speed="0.75">0.75x</div>
                    <div data-speed="1">1x</div>
                    <div data-speed="1.25">1.25x</div>
                    <div data-speed="1.5">1.5x</div>
                    <div data-speed="2">2x</div>
                </div>
            </div>
        </div>
    </div>

    <div class="main-container">
        <!-- Left Panel -->
        <div class="left-panel">

            <div id="part-1" class="question-part">
                <div class="part-header">
                    <p><strong>Part 1</strong></p>
                    <p>Listen and answer questions 1–10.</p>
                </div>
                <div class="questions-container">
                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 1-10</strong></p>
                            <p>Complete the notes below.</p>
                            <p>Write <strong>NO MORE THAN TWO WORDS AND/OR A NUMBER</strong> for each answer.</p>
                        </div>
                        <div style="border: 1px solid #000000; padding: 15px;">
                            <p class="centered-title">Midbury Drama Club</p>
                            <p><strong>Background</strong></p>
                            <ul style="list-style-type: none; padding-left: 20px;">
                                <li>&bull;&nbsp;&nbsp;prize recently won by <input type="text" id="q1"
                                        class="answer-input" placeholder="1"> section</li>
                                <li>&bull;&nbsp;&nbsp;usually performs <input type="text" id="q2" class="answer-input"
                                        placeholder="2"> plays</li>
                            </ul>
                            <p><strong>Meetings</strong></p>
                            <ul style="list-style-type: none; padding-left: 20px;">
                                <li>&bull;&nbsp;&nbsp;next auditions will be on Tuesday <input type="text" id="q3"
                                        class="answer-input" placeholder="3"></li>
                                <li>&bull;&nbsp;&nbsp;help is needed with <input type="text" id="q4"
                                        class="answer-input" placeholder="4"> and <input type="text" id="q4_2"
                                        class="answer-input" placeholder=""></li>
                                <li>&bull;&nbsp;&nbsp;rehearsals take place in the <input type="text" id="q5"
                                        class="answer-input" placeholder="5"> hall</li>
                                <li>&bull;&nbsp;&nbsp;nearest car park for rehearsals is in Ashburton Road opposite the
                                    <input type="text" id="q6" class="answer-input" placeholder="6">
                                </li>
                            </ul>
                            <p><strong>Costs</strong></p>
                            <ul style="list-style-type: none; padding-left: 20px;">
                                <li>&bull;&nbsp;&nbsp;annual membership fee is <input type="text" id="q7"
                                        class="answer-input" placeholder="7"> £</li>
                                <li>&bull;&nbsp;&nbsp;extra payment for <input type="text" id="q8" class="answer-input"
                                        placeholder="8"></li>
                            </ul>
                            <p><strong>Contact</strong></p>
                            <ul style="list-style-type: none; padding-left: 20px;">
                                <li>&bull;&nbsp;&nbsp;secretary's name is Sarah <input type="text" id="q9"
                                        class="answer-input" placeholder="9"></li>
                                <li>&bull;&nbsp;&nbsp;secretary's phone number is <input type="text" id="q10"
                                        class="answer-input" placeholder="10"></li>
                            </ul>
                        </div>

                    </div>
                </div>
            </div>

            <div id="part-2" class="question-part hidden">
                <div class="part-header">
                    <p><strong>Part 2</strong></p>
                    <p>Listen and answer questions 11–20.</p>
                </div>
                <div class="questions-container">
                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 11-15</strong><br>Choose the correct letter, <strong> A, B or
                                    C</strong>.</p>
                        </div>
                        <div class="single-choice-container">
                            <div class="single-choice">
                                <p><strong>11</strong> What does the charity Forward thinking do?</p>
                                <label><input type="radio" name="q11" value="A"> It funds art exhibitions in
                                    hospitals.</label>
                                <label><input type="radio" name="q11" value="B"> It produces affordable materials for
                                    art therapy.</label>
                                <label><input type="radio" name="q11" value="C"> It encourages the use of arts projects
                                    in healthcare.</label>
                            </div>
                            <div class="single-choice">
                                <p><strong>12</strong> What benefit of Forward thinking's work does Jasmine mention?</p>
                                <label><input type="radio" name="q12" value="A"> People avoid going to hospital.</label>
                                <label><input type="radio" name="q12" value="B"> Patients require fewer drugs.</label>
                                <label><input type="radio" name="q12" value="C"> Medical students do better in
                                    tests.</label>
                            </div>
                            <div class="single-choice">
                                <p><strong>13</strong> When did the organization become known as Forward thinking?</p>
                                <label><input type="radio" name="q13" value="A"> 1986</label>
                                <label><input type="radio" name="q13" value="B"> in the 1990s</label>
                                <label><input type="radio" name="q13" value="C"> 2005</label>
                            </div>
                            <div class="single-choice">
                                <p><strong>14</strong> Where does Forward thinking operate?</p>
                                <label><input type="radio" name="q14" value="A"> within Clifton city</label>
                                <label><input type="radio" name="q14" value="B"> in all parts of London</label>
                                <label><input type="radio" name="q14" value="C"> in several towns and villages near
                                    Clifton</label>
                            </div>
                            <div class="single-choice">
                                <p><strong>15</strong> Jasmine explains that the Colville Centre is</p>
                                <label><input type="radio" name="q15" value="A"> a school for people with health
                                    problems.</label>
                                <label><input type="radio" name="q15" value="B"> a venue for a range of different
                                    activities.</label>
                                <label><input type="radio" name="q15" value="C"> a building which needs
                                    repairing.</label>
                            </div>
                        </div>
                    </div>
                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 16-20</strong></p>
                            <p>Who can take part in each of the classes?</p>
                            <p>Write the correct letter <strong>A, B or C</strong> next to questions 16-20.</p>
                            <ul class="mcq-options">
                                <li><strong>A</strong> children and teenagers</li>
                                <li><strong>B</strong> adults</li>
                                <li><strong>C</strong> all ages</li>
                            </ul>
                        </div>
                        <table class="mcq-table" style="width: 100%;">
                            <thead>
                                <tr>
                                    <th>Class</th>
                                    <th>A</th>
                                    <th>B</th>
                                    <th>C</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>16</strong> Learn Salsa</td>
                                    <td><input type="radio" name="q16" value="A"></td>
                                    <td><input type="radio" name="q16" value="B"></td>
                                    <td><input type="radio" name="q16" value="C"></td>
                                </tr>
                                <tr>
                                    <td><strong>17</strong> Smooth Movers</td>
                                    <td><input type="radio" name="q17" value="A"></td>
                                    <td><input type="radio" name="q17" value="B"></td>
                                    <td><input type="radio" name="q17" value="C"></td>
                                </tr>
                                <tr>
                                    <td><strong>18</strong> Art of the Forest</td>
                                    <td><input type="radio" name="q18" value="A"></td>
                                    <td><input type="radio" name="q18" value="B"></td>
                                    <td><input type="radio" name="q18" value="C"></td>
                                </tr>
                                <tr>
                                    <td><strong>19</strong> The Money Maze</td>
                                    <td><input type="radio" name="q19" value="A"></td>
                                    <td><input type="radio" name="q19" value="B"></td>
                                    <td><input type="radio" name="q19" value="C"></td>
                                </tr>
                                <tr>
                                    <td><strong>20</strong> Make a Play</td>
                                    <td><input type="radio" name="q20" value="A"></td>
                                    <td><input type="radio" name="q20" value="B"></td>
                                    <td><input type="radio" name="q20" value="C"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="part-3" class="question-part hidden">
                <div class="part-header">
                    <p><strong>Part 3</strong></p>
                    <p>Listen and answer questions 21–30.</p>
                </div>
                <div class="questions-container">
                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 21-26</strong></p>
                            <p>Choose the correct letter, <strong>A, B or C</strong>.</p>
                        </div>
                        <p class="centered-title">Reflective Journal Assignment</p>
                        <div class="single-choice-container">
                            <div class="single-choice">
                                <p><strong>21</strong> What should be firstly included in the reflective journal?</p>
                                <label><input type="radio" name="q21" value="A"> A topics he is going to talk
                                    about</label>
                                <label><input type="radio" name="q21" value="B"> B study aims for the module</label>
                                <label><input type="radio" name="q21" value="C"> C suggestions from others</label>
                            </div>
                            <div class="single-choice">
                                <p><strong>22</strong> The woman has got</p>
                                <label><input type="radio" name="q22" value="A"> A a lot of friends to help her.</label>
                                <label><input type="radio" name="q22" value="B"> B several books that may be
                                    useful.</label>
                                <label><input type="radio" name="q22" value="C"> C sufficient resources showing that she
                                    is a good technology user.</label>
                            </div>
                            <div class="single-choice">
                                <p><strong>23</strong> What was the man's biggest achievement in the past?</p>
                                <label><input type="radio" name="q23" value="A"> A He worked as a waiter in a
                                    restaurant.</label>
                                <label><input type="radio" name="q23" value="B"> B He got an offer to lead a
                                    team.</label>
                                <label><input type="radio" name="q23" value="C"> C He became the chairman of the Student
                                    Union.</label>
                            </div>
                            <div class="single-choice">
                                <p><strong>24</strong> The man decides to</p>
                                <label><input type="radio" name="q24" value="A"> A do it by himself.</label>
                                <label><input type="radio" name="q24" value="B"> B find a tutor.</label>
                                <label><input type="radio" name="q24" value="C"> C listen to others.</label>
                            </div>
                            <div class="single-choice">
                                <p><strong>25</strong> What is the man's attitude after the discussion?</p>
                                <label><input type="radio" name="q25" value="A"> A He thinks it is useless.</label>
                                <label><input type="radio" name="q25" value="B"> B He is looking forward to doing the
                                    assignment</label>
                                <label><input type="radio" name="q25" value="C"> C He feels uncertain about it.</label>
                            </div>
                            <div class="single-choice">
                                <p><strong>26</strong> What should be shown in the man's reflective journal?</p>
                                <label><input type="radio" name="q26" value="A"> A self-awareness</label>
                                <label><input type="radio" name="q26" value="B"> B mistakes</label>
                                <label><input type="radio" name="q26" value="C"> C achievements</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 27-30</strong></p>
                            <p>What is the woman's attitude toward each of the following activities of study?</p>
                            <p>Choose <strong>FOUR</strong> answers from the box and write the correct letter,
                                <strong>A-E</strong>, next to questions 27-30.
                            </p>

                        </div>
                        <div class="matching-container">
                            <table class="matching-table">
                                <thead>
                                    <tr>
                                        <th>Activity</th>
                                        <th>Answer</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>27</strong> writing an essay</td>
                                        <td>
                                            <div class="drop-zone" data-question-id="27" data-question="q27"><span
                                                    class="placeholder">27</span></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>28</strong> taking exams</td>
                                        <td>
                                            <div class="drop-zone" data-question-id="28" data-question="q28"><span
                                                    class="placeholder">28</span></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>29</strong> making class notes</td>
                                        <td>
                                            <div class="drop-zone" data-question-id="29" data-question="q29"><span
                                                    class="placeholder">29</span></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>30</strong> taking presentation notes</td>
                                        <td>
                                            <div class="drop-zone" data-question-id="30" data-question="q30"><span
                                                    class="placeholder">30</span></div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="matching-options-list">
                                <div class="drag-item" draggable="true" data-option-id="A">A define a problem</div>
                                <div class="drag-item" draggable="true" data-option-id="B">B independent learning</div>
                                <div class="drag-item" draggable="true" data-option-id="C">C develop study skills</div>
                                <div class="drag-item" draggable="true" data-option-id="D">D gain confidence</div>
                                <div class="drag-item" draggable="true" data-option-id="E">E find it difficult</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="part-4" class="question-part hidden">
                <div class="part-header">
                    <p><strong>Part 4</strong></p>
                    <p>Listen and answer questions 31–40.</p>
                </div>
                <div class="questions-container">
                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 31-35</strong></p>
                            <p>Complete the sentences below.</p>
                            <p>Write <strong>ONLY ONE WORD</strong> for each answer.</p>
                        </div>
                        <p class="centered-title">Manufacturing in the English Midlands</p>
                        <p><strong>31</strong> In the eighteenth century, the <input type="text" class="answer-input"
                                id="q31" placeholder="31"> still determined how most people made a living.</p>
                        <p><strong>32</strong> In the ground were minerals which supported the many <input type="text"
                                class="answer-input" id="q32" placeholder="32"> of the region.</p>
                        <p><strong>33</strong> Since the late sixteenth century the French settlers had made <input
                                type="text" class="answer-input" id="q33" placeholder="33"></p>
                        <p><strong>34</strong> In Cheshire <input type="text" class="answer-input" id="q34"
                                placeholder="34"> was mined and transported on the river Mersey.</p>
                        <p><strong>35</strong> Potters worked in a few <input type="text" class="answer-input" id="q35"
                                placeholder="35"> situated on the small hills of North Staffordshire.</p>
                    </div>

                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 36-40</strong></p>
                            <p>Complete the notes below.</p>
                            <p>Write <strong>ONE WORD ONLY</strong> for each answer.</p>
                        </div>
                        <div style="border: 1px solid #000000; padding: 15px;">
                            <p class="centered-title">Pottery notes</p>
                            <p><strong>Earthenware</strong></p>
                            <p style="list-style-type: none; padding-left: 20px; font-weight: 600;">Advantages:</p>
                            <ul style="list-style-type: none; padding-left: 40px;">
                                <li>&bull;&nbsp;&nbsp;pottery used <input type="text" class="answer-input" id="q36"
                                        placeholder="36"> clay</li>
                                <li>&bull;&nbsp;&nbsp;saved money on <input type="text" class="answer-input" id="q37"
                                        placeholder="37"></li>
                            </ul>
                            <p style="list-style-type: none; padding-left: 20px; font-weight: 600;">Disadvantages:</p>
                            <ul style="list-style-type: none; padding-left: 40px;">
                                <li>&bull;&nbsp;&nbsp;needed two firings in the Kiln to be <input type="text"
                                        class="answer-input" id="q38" placeholder="38"></li>
                                <li>&bull;&nbsp;&nbsp;fragility led to high <input type="text" class="answer-input"
                                        id="q39" placeholder="39"> during manufacturing</li>
                            </ul>
                            <p><strong>Stoneware</strong></p>
                            <ul style="list-style-type: none; padding-left: 20px;">
                                <li>&bull;&nbsp;&nbsp;more emotive but better</li>
                                <li>&bull;&nbsp;&nbsp;made from a <input type="text" class="answer-input" id="q40"
                                        placeholder="40"> of clay and flint</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="right-panel">
            <div id="transcription-container">
                <h2>Transcription</h2>
                <pre id="transcription-text"></pre>
            </div>
        </div>
    </div>

    <div id="transcription-data" style="display:none;">
        <div data-part="1">Section 1. You will hear a woman talking to a man about joining a drama club. First, you have
            some time to look at questions 1 to 6. Pause the recording for 30 seconds. You will see that there is an
            example that has been done for you.

            On this occasion only, the conversation relating to this will be played first. Hello, Robert Gladwell
            speaking. Oh, hi.

            My name's Chloe Martin. I was given your name and phone number by Ben Winters. I work with him and he said
            you're a member of Midbury Drama Club.

            Yes, I am. Well, I've just moved to the area and I'm keen to join a drama club. Great.

            Yes, I can give you some information. We're one of the oldest drama clubs in the area as the club started in
            1957. We now have about 60 members.

            Our youngest member is 10 and our oldest member is 78. The year the drama club started was 1957, so 1957 has
            been written in the space. Now we shall begin.

            You should answer the questions as you listen. Because you will not hear the recording a second time. Listen
            carefully and answer questions 1 to 6. Hello, Robert Gladwell speaking.

            Oh, hi. My name's Chloe Martin. I was given your name and phone number by Ben Winters.

            I work with him and he said you're a member of Midbury Drama Club. Yes, I am. Well, I've just moved to the
            area and I'm keen to join a drama club.

            Great. Yes, I can give you some information. We're one of the oldest drama clubs in the area as the club
            started in 1957.

            We now have about 60 members. Our youngest member is 10 and our oldest member is 78. Oh, I think I saw a
            picture in the newspaper the other day of some of your members being presented with a prize.

            Yes, the youth section did very well in a competition and won £100, which will help with their next
            production. Anyway, tell me a bit more about yourself. Well, I've done a bit of acting.

            I was in a couple of musicals when I was at university and a historical play more recently. We mainly do
            comedy plays. We get good audiences for that kind of thing.

            We haven't attempted a musical yet, but we might do one soon. Oh, when do you usually meet? On Tuesdays.
            Well, presumably I'll need to do an audition.

            Yes, there were a few auditions last Tuesday, and we'll be doing more at our next meeting, which is in two
            weeks' time. That's on Tuesday, the 12th of March. There'll be another opportunity two weeks after that,
            which will be on the 26th of March.

            Oh, well, I can come to your next meeting, and if I don't get an acting part in a play, I'd be happy to help
            with something else. I've designed publicity before. Great! We're very short of people who can do that, so
            that would be really good.

            There are a lot of people who like making scenery, so we get plenty of help with that, but we haven't got
            enough people to do the lights at the moment. So, if you think you can do that, or you have any friends who
            would like to, do bring them along. We can show you what to do if you haven't got any experience.

            I'll have to think about it. So, do you meet in the theatre? We do our performances in the Manor Theatre,
            but we only hire that for the nights of the actual performances. We meet to rehearse every Tuesday evening
            in the Community Hall.

            We rent a room there. Oh, I'm not sure where that is. I'll be coming by car because I don't live in the town
            centre.

            It's in Ashburton Road. As you're coming towards the centre, down Regent Street, you need to turn left at
            the crossroads. Oh, I know.

            There's a big car park down there, just before you get to a hotel. It's on the other side of the road from
            the Sports Centre. That's it.

            That's the closest place to leave your car, and you don't have to pay in the evening to park there. We meet
            at 7.30, and we usually finish by 9.30 or 10. OK.

            Before you hear the rest of the conversation, you have some time to look at questions 7 to 10. Pause the
            recording for 30 seconds. Now listen and answer questions 7 to 10.

            I haven't mentioned that we have to make a charge. Everyone pays a subscription of £180 to be a member for a
            year. You can pay for the whole year at once, or you can pay £15 every month.

            It works out the same. There are reductions for retired people and under-18s, but I don't think you come
            into either category. No, I'm 26.

            Oh, that fee covers all the costs, like photocopying of scripts and producing the posters, but it excludes
            the costumes for the performances. We ask people to pay for the hire of those themselves. It does mean they
            look after them properly, as they know they won't get their deposit back otherwise.

            Can I come along to the next meeting then? Of course. We'd love to see you. And if you want to know more
            about how we run the auditions or the next play we're doing, why don't you give our secretary a ring? She'll
            be really pleased to help you.

            Oh, what's her name? It's Sarah Sordicott. That's S-A-W-D-I-C-O-T. Got that.

            And her phone number? I've only got a mobile number for her. Just a minute. Let me find it.

            Ah, it's 07955 240063. Great. Thanks for your help.

            That is the end of section one. You now have half a minute to check your answers.</div>
        <div data-part="2">Section two.

            You will hear a radio programme in which a presenter called Jasmine tells her colleague Fergus about a
            charity. First, you have some time to look at questions 11 to 15. Pause the recording for 30 seconds.

            Now listen carefully and answer questions 11 to 15. And now here's Jasmine, who's come to tell us about this
            week's charity. Hi, Fergus.

            This week, I'm going to talk about Forward Thinking and their plans for the Colville Centre. So, in recent
            years, people have realised how useful the arts can be within healthcare. The idea behind Forward Thinking
            is to use the arts to promote wellbeing.

            The charity develops projects for people with special needs and health problems and also delivers training
            to healthcare professionals in using the arts, as well as supplying them with information and advice.
            Forward Thinking doesn't just run art and craft classes to distract people who are ill or recovering from
            illness, but arranges longer-term projects and courses, as it's been shown that the arts can bring all sorts
            of positive changes in patients, including benefits such as shortening the length of stay in hospital and
            reducing the amounts of medicine they need. I see.

            Forward Thinking has experience of working with a broad range of people, from young adults with learning
            difficulties to older people in homes or daycare centres and people with physical disabilities. The
            organisation's been around since 1986 and it gradually expanded during the 1990s. Then, in the new
            millennium, it was decided to find a memorable name, so it's been operating as Forward Thinking for several
            years, in fact, since 2005.

            It's quite a locally-based charity, mainly for people in the southern part of this region, which includes
            all rural and urban communities outside the city of Clifton, which has its own organisation. There are, of
            course, some similar charities in other parts of the country, in London and so on. And what's the present
            fundraising in aid of? Yeah, well, the charity needs funding in order to buy the Colville Centre.

            This is a former village school, which was built in 1868. It was modernised and refurbished by the present
            owners last year, so it's ideal for art classes and for small social events, performances, seminars and so
            on. Forward Thinking is fundraising to purchase the building so they can use it to continue running classes
            and so on for the general public and eventually also for some of the people they help.

            Before you hear the rest of the talk, you have some time to look at questions 16 to 20. Pause the recording
            for 30 seconds. Now listen and answer questions 16 to 20.

            Right, so can you give us a few ideas about what classes people might do there? Is it all art classes? Well,
            there are some very good art classes, but there are lots of other things going on as well. So, for example,
            there's Learn Salsa with Nina Bellina's team. They say that salsa is an easy dance to learn.

            It's also an excellent form of exercise, according to Nina. And that class is for both men and women, of
            course. It's ideal for beginners and what they call refreshers.

            That's £100 for 10 sessions. Then another class is called Smooth Movers. It's with Kevin Bennett.

            And it's for you if you don't have the same energy levels as you used to when you were a teenager. It's a
            gentle exercise class geared to the needs of whoever is in the group in a particular session. And Kevin is
            qualified to teach classes to people getting over injuries and so on and balance training.

            That's £60 for 10 sessions. Then there's a day called Art of the Forest with Jamie Graham, where you
            discover Upper Wood, a short walk from the Colville Centre, and learn how to design in 3D with natural
            materials. It's an unusual and exciting way to be creative.

            Jamie is an artist with a background also as a country park ranger. For this day, youngsters must be
            accompanied by a parent or guardian, and the costs are adults £40, under-14s £10. But it's best value at £80
            for a family of four.

            The next one is The Money Maze. And this is a series of talks by Peter O'Reilly, an independent financial
            advisor. He gives advice on family finances, things like everything parents need to know about managing the
            costs of bringing up children, sending them to university, and actually also about care for elderly
            relatives.

            It's £10 per talk, which will all go to support forward thinking. And as a final example of what's on offer,
            there's Make a Play. That's for 8-14s, and this activity is such a hit that it usually sells out within days
            of being announced.

            Basically, what you do is write, rehearse and perform a play in just two days, and it doesn't require any
            previous experience. I gather there's lots of fun and silliness along the way. And the best bit, perhaps, is
            that there's a performance for family and friends at the end.

            It's just £50 for two days. Pretty good range of activities, I think. And all raising money for a good
            cause.

            Yes, and the all-important contact details are colville at forwardthinking.org.uk or write. That is the end
            of section 2. You now have half a minute to check your answers.</div>
        <div data-part="3">Section 3 You will hear Tom and Danny, two students, talking with their professor about the
            assignment.

            First, you have some time to look at questions 21 to 26. Now listen carefully and answer questions 21 to 26.
            Professor Tomlinson, may Annie and I please quickly ask you a few questions about the reflective journal
            assignment? It's just that we're a bit confused as to what you want us to include and discuss.

            Yes, of course. What are you having trouble with? Well, everything really. To start with, what should be
            included first in the reflective journal? Perhaps suggestions from others? No, no.

            Firstly, you should include the study goals you set yourself at the beginning of the module. This section
            should have been discussed in some detail towards the beginning of the course by Professor May. You should
            be able to find her suggestions on the slides she has provided the class online.

            OK, thank you, Professor. Could I also trouble you to take a brief look at my bibliography and footnotes? I
            feel like they're missing something. Most of our friends' bibliographies are longer.

            Well, looking at this, Annie, I can see that you have used a wide range of resources, which shows that you
            have made effective use of communication technology. As far as I can tell, you need not make any changes to
            this. Although you might want to double-check that your referencing complies with the Harvard Referencing
            Style regulations.

            Oh, I'm very surprised you've said that. Thank you. Now I can set my mind at ease.

            Tom, you said you wanted to ask the Professor about the achievement section? Ah yes, Professor. In the
            assignment guidelines, we're asked to introduce and elaborate on our biggest achievement in the past, saying
            which skills we learned in the process and how these skills can be transferred to various different future
            careers. The only problem is that I don't know what my greatest achievement actually is.

            I've only ever worked as a waiter in a hotel restaurant during the summer holidays from university. If you
            worked as a waiter in a hotel restaurant, you're bound to have worked with other waiters as part of a team.
            Would you say that during your time as a waiter, you developed any leadership skills? Yes, well, I suppose I
            was asked to become the team leader of the food and beverage department, but that's hardly an achievement.

            You might not think so, but if you write that you were offered the position of the team leader, it shows a
            lot more about your character. For example, that you're charismatic and work well in a high-pressure
            situation. I never would have thought to write that down, thank you.

            I guess I should start listening to others more often. Annie, do you have any more questions, or are you
            ready to go back to the library? Yeah, I think I've got everything I need. Thank you very much, Professor
            Tomlinson.

            That was really helpful. I'm actually starting to look forward to writing this now, and it should be a
            really useful exercise to prepare us for writing CVs and applying for jobs. It's shocking how bad I am at
            identifying my strengths and weaknesses.

            Professor Tomlinson has shown me that I definitely need to start displaying some self-awareness. Yeah, Tom,
            you really do. You're always so modest.

            Modesty is great until it comes to applying for jobs. Before you hear the rest of the conversation, you have
            some time to look at questions 27 to 30. Now listen and answer questions 27 to 30.

            Oh no, I forgot to ask the professor about the section on identifying the skills gained through different
            activities. Do you remember? When it asks you, for example, whether writing an essay develops your study
            skills, or your independent learning, and so on. Oh goodness, we really should have asked him that.

            I've been having trouble with it too. It just seems like such a pointless task. What do you reckon the
            answers are? I think writing an essay might be a way of identifying and resolving a problem, because you
            have to state the problem in the introduction and then solve it.

            I'm not so sure about taking exams. I thought they were supposed to develop lots of different skill sets. If
            I really had to choose, I'd say that taking exams enables you to become more confident in yourself.

            Do you agree? Maybe. I really don't know either. What do you think about the last two? Making class notes
            and presentation notes? Oh, it's so difficult.

            I think making class notes has to be a way of becoming a more independent learner, because you yourself
            decide what the important information is and learn it. That reminds me, I find taking presentation notes is
            a disaster. The professors speak much too quickly and I write much too slowly.

            That is the end of section three. You now have half a minute to check your answers.</div>
        <div data-part="4">Section four. You will hear a lecturer giving the beginning of a talk on the history of
            British pottery. First, you have some time to look at questions thirty-one to forty.

            Pause the recording for one minute. Now listen carefully and answer questions thirty-one to forty. Thank you
            for coming to this series of talks.

            Before I talk in detail about the experiments and innovations of the British ceramicists, I'd like to give
            you a summary of the social and manufacturing background in which they lived and worked. So, we're talking
            about England, or more specifically, the region known as the Midlands, and we need to go back, mainly to the
            18th century, and briefly even earlier, to put it in a global context. Now, at that period, the majority of
            the population, whatever their station in life, as you might say, were dependent for their living, in one
            way or another, not on the geographical location of where they lived, but on the physical characteristics of
            the actual land they lived on.

            This is true whether we're talking about the aristocracy, the owners of great estates who, incidentally, had
            no snobbery about the concept of making money from all the reserves of coal, or timber, or stone, on their
            rolling acres, or the farmers making a fat living from the rich soils. And besides these groups, and the
            less affluent ones, the deposits of iron ore and lead, the limestone and flint, and the brown and yellow
            clays also sustained the numerous industries in the area. It's important to recognise that it was already an
            industrial region, and had been so for centuries.

            There were many Midland trades, some of them indigenous, some of them not. For example, there were
            immigrants from France who came as early as the late 16th century, and they were producers of glass. A
            century later, there is plenty of evidence that the variety of trades was enormous.

            There was brewing in Burton-on-Trent, silk weaving and ribbon making near Coventry, framework knitting
            around Nottingham, and of course, in Cheshire, men dug the salt, as we still do nowadays even, which in that
            era was sent downriver to the estuary of the Mersey. Now, among these well-established trades, one of the
            oldest of the local crafts was pottery. As you will probably be aware, ceramics has always been a mix of
            science, design, and skill.

            And a good potter is, in a sense, an experimental chemist, trying out new mixes and glazes, and needing to
            be alert to the impact of changes of temperature on different types of clay. For 200 years, up to the time
            we are concerned with, potters had been making butter pots and pitchers and patterned plates, using the clay
            which was plentiful in the area where they lived, in a handful of North Staffordshire villages dotted along
            the low hills. Now I want to explain a little about the industrial processes which had preceded the great
            breakthrough in Germany in 1708.

            That's when the formula for porcelain was discovered, a secret that had been held in China for a thousand
            years. In the Midlands, in England as elsewhere, there had basically been two kinds of pottery. The first
            was known, is still known, as earthenware.

            Now, this was a bit rough and ready, but it was deservedly popular for several reasons. To start with, it
            was relatively cheap, so it could be used by most households. This was because it could be made from local
            clay, without any complicated processing or added materials.

            From the potter's point of view, there was another reason for its cheapness. This was that it could be fired
            in simple ovens or kilns and at relatively low temperatures, so he didn't have to spend so much money on
            fuel to achieve the necessary heat. On the other hand, after one firing in the kiln, the problem with
            earthenware was that it remained porous, so had limited usefulness.

            So for most purposes, it had to go back in the kiln for a second firing before it became waterproof. And
            another thing was that it was extremely breakable. I mean, before it had even been sold.

            I suppose the potter wouldn't have minded so much if people just had to keep coming back for more every time
            they broke a jug or whatever. But it was very inconvenient, because it meant there was a lot of wastage in
            the course of the manufacturing process. Anyway, for all these reasons, if people could afford it, and that
            would be all but the very poor, they would buy stoneware, a much tougher product.

            Now, for this, the potter used a slightly more expensive raw material, which was made by combining clay and
            flint. And this mixture was fired at a far higher heat, with the result that the ingredients vitrified. That
            is to say, in effect, the whole thing became glassy.

            And because of this, it was non-porous, and naturally, this was regarded as a great advance. Well, that's
            the situation in the 18th century. Are there any questions at this stage? OK, so now we can go on to look at
            the age of innovation.</div>
    </div>

    <audio id="global-audio-player" class="hidden"></audio>

    <!-- Navigation Arrows -->
    <div class="nav-arrows">
        <button class="nav-arrow" onclick="previousPart()" id="prevBtn">‹</button>
        <button class="nav-arrow" onclick="nextPart()" id="nextBtn">›</button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-row perScorableItem" aria-label="Questions">
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(1)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">1</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(1)"><span class="sr-only">Question
                        1</span><span aria-hidden="true">1</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(2)"><span class="sr-only">Question
                        2</span><span aria-hidden="true">2</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(3)"><span class="sr-only">Question
                        3</span><span aria-hidden="true">3</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(4)"><span class="sr-only">Question
                        4</span><span aria-hidden="true">4</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(5)"><span class="sr-only">Question
                        5</span><span aria-hidden="true">5</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(6)"><span class="sr-only">Question
                        6</span><span aria-hidden="true">6</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(7)"><span class="sr-only">Question
                        7</span><span aria-hidden="true">7</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(8)"><span class="sr-only">Question
                        8</span><span aria-hidden="true">8</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(9)"><span class="sr-only">Question
                        9</span><span aria-hidden="true">9</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(10)"><span class="sr-only">Question
                        10</span><span aria-hidden="true">10</span></button>
            </div>
        </div>

        <div class="footer__questionWrapper___1tZ46 selected multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(2)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">2</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(11)"><span class="sr-only">Question
                        11</span><span aria-hidden="true">11</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(12)">
                    <span class="sr-only">Question 12</span>
                    <span aria-hidden="true">12</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(13)">
                    <span class="sr-only">Question 13</span>
                    <span aria-hidden="true">13</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(14)">
                    <span class="sr-only">Question 14</span>
                    <span aria-hidden="true">14</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(15)">
                    <span class="sr-only">Question 15</span>
                    <span aria-hidden="true">15</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(16)">
                    <span class="sr-only">Question 16</span>
                    <span aria-hidden="true">16</span>
                </button>
                <button class="subQuestion active scorable-item" onclick="goToQuestion(17)">
                    <span class="sr-only">Question 17</span>
                    <span aria-hidden="true">17</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(18)">
                    <span class="sr-only">Question 18</span>
                    <span aria-hidden="true">18</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(19)">
                    <span class="sr-only">Question 19</span>
                    <span aria-hidden="true">19</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(20)">
                    <span class="sr-only">Question 20</span>
                    <span aria-hidden="true">20</span>
                </button>
            </div>
        </div>

        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(3)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">3</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(21)"><span class="sr-only">Question
                        21</span><span aria-hidden="true">21</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(22)"><span class="sr-only">Question
                        22</span><span aria-hidden="true">22</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(23)"><span class="sr-only">Question
                        23</span><span aria-hidden="true">23</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(24)"><span class="sr-only">Question
                        24</span><span aria-hidden="true">24</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(25)"><span class="sr-only">Question
                        25</span><span aria-hidden="true">25</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(26)"><span class="sr-only">Question
                        26</span><span aria-hidden="true">26</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(27)"><span class="sr-only">Question
                        27</span><span aria-hidden="true">27</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(28)"><span class="sr-only">Question
                        28</span><span aria-hidden="true">28</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(29)"><span class="sr-only">Question
                        29</span><span aria-hidden="true">29</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(30)"><span class="sr-only">Question
                        30</span><span aria-hidden="true">30</span></button>
            </div>
        </div>

        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(4)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">4</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(31)"><span class="sr-only">Question
                        31</span><span aria-hidden="true">31</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(32)"><span class="sr-only">Question
                        32</span><span aria-hidden="true">32</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(33)"><span class="sr-only">Question
                        33</span><span aria-hidden="true">33</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(34)"><span class="sr-only">Question
                        34</span><span aria-hidden="true">34</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(35)"><span class="sr-only">Question
                        35</span><span aria-hidden="true">35</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(36)"><span class="sr-only">Question
                        36</span><span aria-hidden="true">36</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(37)"><span class="sr-only">Question
                        37</span><span aria-hidden="true">37</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(38)"><span class="sr-only">Question
                        38</span><span aria-hidden="true">38</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(39)"><span class="sr-only">Question
                        39</span><span aria-hidden="true">39</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(40)"><span class="sr-only">Question
                        40</span><span aria-hidden="true">40</span></button>
            </div>
        </div>

        <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton___3FM07">
            <i class="fa fa fa-check" aria-hidden="true"></i>
            <span>Check Answers</span>
        </button>
    </nav>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div class="context-menu-item" id="highlight-item" onclick="highlightText()">
            <span class="context-menu-icon">
                <svg viewBox="0 0 24 24" fill="black">
                    <path
                        d="M15.24 12.32L12.28 9.36l-1.04 1.04-1.04-1.04-1.04 1.04-1.04-1.04-1.04 1.04-1.04-1.04-3.12 3.12c-.59.58-1.54.58-2.12 0l-1.04-1.04c-.58-.59-.58-1.54 0-2.12L7.88.88c.59-.58 1.54-.58 2.12 0l1.04 1.04 1.04-1.04 1.04 1.04 1.04-1.04 1.04 1.04 1.04-1.04 3.12 3.12c.58.59.58 1.54 0 2.12l-1.04 1.04c-.58.59-1.54.59-2.12 0zM12 15l-3 3-7-7 3-3 7 7zm-9-5l-2.29 2.29c-.39.39-.39 1.02 0 1.41l8.29 8.29c.39.39 1.02.39 1.41 0L22.7 8.41c.39-.39.39-1.02 0-1.41L14.42.29c-.39-.39-1.02-.39-1.41 0L3 10z" />
                </svg>
            </span>
            <span>Highlight</span>
        </div>
        <div class="context-menu-item" id="comment-item" onclick="addComment()">
            <span class="context-menu-icon">
                <svg viewBox="0 0 24 24" fill="black">
                    <path
                        d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 12H5.17L4 15.17V4h16v10z" />
                </svg>
            </span>
            <span>Comment</span>
        </div>
        <div class="context-menu-item" id="clear-item" onclick="clearHighlight()" style="display:none;">
            <span class="context-menu-icon">
                <svg viewBox="0 0 24 24" fill="black">
                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />
                </svg>
            </span>
            <span>Clear</span>
        </div>
        <div class="context-menu-item" onclick="clearAllHighlights()">
            <span class="context-menu-icon">
                <svg viewBox="0 0 24 24" fill="black">
                    <path
                        d="M16 9h-2.29l3-3-1.42-1.42-3 3V5h-2v2.29l-3-3-1.42 1.42 3 3H5v2h2.29l-3 3 1.42 1.42 3-3V17h2v-2.29l3 3 1.42-1.42-3-3H17V9h-2zm-4 4h-2v-2h2v2z" />
                </svg>
            </span>
            <span>Clear All</span>
        </div>
    </div>

    <!-- Mobile highlight/comment toolbar -->
    <div id="mobile-selection-menu" class="mobile-selection-menu hidden">
        <button onclick="highlightText()">Highlight</button>
        <button onclick="addComment()">Comment</button>
    </div>

    <!-- Result Modal -->
    <div id="result-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Your Results</h2>
                <button id="modal-close-button" class="modal-close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p id="score-summary"></p>
                <div id="result-details"></div>
            </div>
        </div>
    </div>

    <script>
        let currentPart = 1;
        let currentQuestion = 1;
        let selectedText = '';
        let selectedRange = null;
        let draggedElement = null;
        let testStarted = false;
        let timeInSeconds = 3600;
        let isHovering = false;
        let timerInterval;
        let contextElement = null;

        function updateAnsweredIndicators() {
            for (let qNum = 1; qNum <= 40; qNum++) {
                const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                if (!btn) continue;

                // Do not change style if it's already marked correct or incorrect
                if (btn.classList.contains('correct') || btn.classList.contains('incorrect')) {
                    continue;
                }

                let isAnswered = false;
                const textInput = document.getElementById(`q${qNum}`);
                const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
                const dropZone = document.querySelector(`.drop-zone[data-question-id="${qNum}"]`);

                if (textInput && textInput.value.trim() !== '') {
                    isAnswered = true;
                } else if (radioInput) {
                    isAnswered = true;
                } else if (dropZone && dropZone.querySelector('.drag-item')) {
                    isAnswered = true;
                } else if ((qNum >= 17 && qNum <= 18) && document.querySelector('input[name="q17-18"]:checked')) {
                    isAnswered = true;
                } else if ((qNum >= 19 && qNum <= 20) && document.querySelector('input[name="q19-20"]:checked')) {
                    isAnswered = true;
                } else if ((qNum >= 21 && qNum <= 23) && document.querySelector('input[name="q21-23"]:checked')) {
                    isAnswered = true;
                }

                if (isAnswered) {
                    btn.classList.add('answered');
                } else {
                    btn.classList.remove('answered');
                }
            }
        }

        const audioPlayer = document.getElementById('global-audio-player');
        const timerContainer = document.querySelector('.timer-container');
        const timerDisplay = document.querySelector('.timer-display');
        const volumeSlider = document.getElementById('new-volume-slider');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const progressBar = document.getElementById('progress-bar');
        const currentTimeEl = document.getElementById('current-time');
        const totalDurationEl = document.getElementById('total-duration');
        const speedBtn = document.getElementById('speed-btn');
        const speedOptions = document.getElementById('speed-options');
        const volumeBtn = document.getElementById('volume-btn');

        const audioSource = 'https://ia601005.us.archive.org/35/items/full-copy-copy-copy-copy-copy-copy-copy/full%20-%20CopyCopyCopyCopyCopyCopyCopy.mp3';
        audioPlayer.src = audioSource;

        const correctAnswers = {
            'q1': ['youth'],
            'q2': ['comedy', 'comedies'],
            'q3': ['12th march', 'march 12th', '12 march', 'march 12'],
            'q4': ['publicity', 'design', 'lights'],
            'q5': ['community'],
            'q6': ['sports centre', 'sport centre'],
            'q7': ['180'],
            'q8': ['costumes', 'costume hire'],
            'q9': ['sawdicott'],
            'q10': ['07955240063', '07955 240063'],
            'q11': 'C',
            'q12': 'B',
            'q13': 'C',
            'q14': 'C',
            'q15': 'B',
            'q16': 'B',
            'q17': 'B',
            'q18': 'C',
            'q19': 'B',
            'q20': 'A',
            'q21': 'B',
            'q22': 'C',
            'q23': 'B',
            'q24': 'C',
            'q25': 'B',
            'q26': 'A',
            'q27': 'A',
            'q28': 'D',
            'q29': 'B',
            'q30': 'E',
            'q31': ['land'],
            'q32': ['industries', 'trades'],
            'q33': ['glass'],
            'q34': ['salt'],
            'q35': ['villages'],
            'q36': ['local'],
            'q37': ['fuel'],
            'q38': ['waterproof'],
            'q39': ['wastage', 'waste'],
            'q40': ['mixture', 'mix', 'combination']
        };

        const questionTypes = {
            'q1': 'text', 'q2': 'text', 'q3': 'text', 'q4': 'text_unordered_pair', 'q5': 'text',
            'q6': 'text', 'q7': 'text', 'q8': 'text', 'q9': 'text', 'q10': 'text',
            'q11': 'mcq', 'q12': 'mcq', 'q13': 'mcq', 'q14': 'mcq', 'q15': 'mcq',
            'q16': 'mcq', 'q17': 'mcq', 'q18': 'mcq', 'q19': 'mcq', 'q20': 'mcq',
            'q21': 'mcq', 'q22': 'mcq', 'q23': 'mcq', 'q24': 'mcq', 'q25': 'mcq', 'q26': 'mcq',
            'q27': 'drag_drop', 'q28': 'drag_drop', 'q29': 'drag_drop', 'q30': 'drag_drop',
            'q31': 'text', 'q32': 'text', 'q33': 'text', 'q34': 'text', 'q35': 'text',
            'q36': 'text', 'q37': 'text', 'q38': 'text', 'q39': 'text', 'q40': 'text'
        };


        function setupCheckboxLimits() {
            const checkboxGroups = [
                { name: 'q18-20', limit: 3 },
            ];

            checkboxGroups.forEach(group => {
                const checkboxes = document.querySelectorAll(`input[name="${group.name}"]`);
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('click', () => {
                        const checkedCount = document.querySelectorAll(`input[name="${group.name}"]:checked`).length;
                        if (checkedCount > group.limit) {
                            checkbox.checked = false;
                        }
                    });
                });
            });
        }

        function switchToPart(partNumber, andPlay = false) {
            if (currentPart !== partNumber) {
                const firstQuestionOfPart = (partNumber - 1) * 10 + 1;
                currentQuestion = firstQuestionOfPart;
            }

            currentPart = partNumber;

            updateNavigation();
            document.querySelectorAll('.question-part').forEach(part => part.classList.add('hidden'));
            const partToShow = document.getElementById(`part-${partNumber}`);
            if (partToShow) {
                partToShow.classList.remove('hidden');
            }

            if (document.querySelector('.main-container.results-mode')) {
                const transcriptionSource = document.querySelector(`#transcription-data [data-part="${partNumber}"]`);
                const transcriptionTarget = document.getElementById('transcription-text');
                if (transcriptionSource && transcriptionTarget) {
                    transcriptionTarget.innerHTML = transcriptionSource.innerHTML;
                }
            }

            updateNavigation();
        }

        function updateNavigation() {
            document.querySelectorAll('.footer__questionWrapper___1tZ46').forEach((wrapper, index) => {
                wrapper.classList.remove('selected');
                updateAttemptedCount(index + 1);
            });
            const currentWrapper = document.querySelectorAll('.footer__questionWrapper___1tZ46')[currentPart - 1];
            if (currentWrapper) {
                currentWrapper.classList.add('selected');
            }
            document.getElementById('prevBtn').disabled = currentQuestion === 1;
            document.getElementById('nextBtn').disabled = currentQuestion === 40;
        }

        function goToQuestion(questionNumber) {
            currentQuestion = questionNumber;
            let partNumber = 1;
            if (questionNumber > 10 && questionNumber <= 20) partNumber = 2;
            else if (questionNumber > 20 && questionNumber <= 30) partNumber = 3;
            else if (questionNumber > 30) partNumber = 4;
            if (currentPart !== partNumber) {
                switchToPart(partNumber);
            }
            document.querySelectorAll('.subQuestion').forEach(btn => btn.classList.remove('active'));
            const questionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${questionNumber})"]`);
            if (questionBtn) questionBtn.classList.add('active');

            // Scroll to the question
            let questionElement;
            if (questionNumber >= 18 && questionNumber <= 20) {
                questionElement = document.querySelector('input[name="q18-20"]');
            } else if (questionNumber >= 17 && questionNumber <= 18) {
                questionElement = document.querySelector('input[name="q17-18"]');
            } else if (questionNumber >= 19 && questionNumber <= 20) {
                questionElement = document.querySelector('input[name="q19-20"]');
            } else {
                questionElement = document.getElementById(`q${questionNumber}`) || // text inputs
                    document.querySelector(`[data-question-id="${questionNumber}"]`) || // drag-drop
                    document.querySelector(`input[name="q${questionNumber}"]`); // radio buttons
            }

            if (questionElement) {
                const questionContainer = questionElement.closest('.question');
                if (questionContainer) {
                    questionContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    questionContainer.classList.add('flash');
                    setTimeout(() => {
                        questionContainer.classList.remove('flash');
                    }, 1000);
                }
            }
            updateNavigation();
        }

        function nextPart() {
            if (currentQuestion < 40) {
                goToQuestion(currentQuestion + 1);
            }
        }

        function previousPart() {
            if (currentQuestion > 1) {
                goToQuestion(currentQuestion - 1);
            }
        }

        function highlightText() {
            if (!selectedRange || selectedRange.collapsed) {
                closeContextMenu();
                return;
            }
            try {
                const span = document.createElement('span');
                span.className = 'highlight';
                selectedRange.surroundContents(span);
            } catch (err) {
                console.warn('Complex selection – fallback highlight');
                document.execCommand('backColor', false, 'yellow');
            }
            window.getSelection().removeAllRanges();
            closeContextMenu();
        }

        function addComment() {
            const commentText = prompt('Enter your comment:');
            if (!commentText || !selectedRange || selectedRange.collapsed) {
                closeContextMenu();
                return;
            }
            try {
                const span = document.createElement('span');
                span.className = 'comment-highlight';
                const tooltip = document.createElement('span');
                tooltip.className = 'comment-tooltip';
                tooltip.textContent = commentText;
                span.appendChild(tooltip);
                selectedRange.surroundContents(span);
            } catch (err) {
                console.warn('Complex selection – cannot comment');
            }
            window.getSelection().removeAllRanges();
            closeContextMenu();
        }

        function clearHighlight() {
            const elementToClear = contextElement; // Set by contextmenu handler
            if (!elementToClear) {
                closeContextMenu();
                return;
            }

            const highlightId = elementToClear.getAttribute('data-highlight-id');
            const elementsToClear = highlightId
                ? Array.from(document.querySelectorAll(`[data-highlight-id="${highlightId}"]`))
                : [elementToClear];

            let commonParent = null;
            if (elementsToClear.length > 0) {
                commonParent = elementsToClear[0].parentNode;
            }

            elementsToClear.forEach(element => {
                const parent = element.parentNode;
                const fragment = document.createDocumentFragment();

                while (element.firstChild) {
                    // Don't keep the tooltip for comments. Just unwrap everything.
                    if (element.firstChild.nodeType === 1 && element.firstChild.classList.contains('comment-tooltip')) {
                        element.removeChild(element.firstChild);
                    } else {
                        fragment.appendChild(element.firstChild);
                    }
                }
                parent.replaceChild(fragment, element);
            });

            if (commonParent) {
                commonParent.normalize(); // Merges adjacent text nodes
            }

            closeContextMenu();
        }

        function clearAllHighlights() {
            document.querySelectorAll('.highlight, .comment-highlight').forEach(element => {
                const parent = element.parentNode;
                const fragment = document.createDocumentFragment();

                while (element.firstChild) {
                    if (element.firstChild.nodeType === 1 && element.firstChild.classList.contains('comment-tooltip')) {
                        element.removeChild(element.firstChild);
                    } else {
                        fragment.appendChild(element.firstChild);
                    }
                }
                parent.replaceChild(fragment, element);
            });
            closeContextMenu();
        }

        function closeContextMenu() {
            document.getElementById('contextMenu').style.display = 'none';
            contextElement = null;
        }

        function updateAttemptedCount(partNumber) {
            const partContainer = document.getElementById(`part-${partNumber}`);
            if (!partContainer) return;
            const inputs = partContainer.querySelectorAll('input.answer-input:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled])');
            let answeredCount = 0;
            const answeredGroups = {};
            inputs.forEach(input => {
                if (input.type === 'radio' || input.type === 'checkbox') {
                    if (input.checked && !answeredGroups[input.name]) {
                        answeredCount++;
                        answeredGroups[input.name] = true;
                    }
                } else {
                    if (input.value.trim() !== '') answeredCount++;
                }
            });
            const countDisplay = document.querySelector(`.footer__questionWrapper___1tZ46:nth-child(${partNumber}) .attemptedCount`);
            if (countDisplay) countDisplay.textContent = `${answeredCount} of 10`;
        }

        function checkAnswers() {
            let score = 0;
            let resultsData = [];
            document.querySelectorAll('.correct, .incorrect, .correct-answer-text').forEach(el => el.classList.contains('correct-answer-text') ? el.remove() : el.classList.remove('correct', 'incorrect'));

            // For unordered pair questions like q4
            const q4_1 = document.getElementById('q4');
            const q4_2 = document.getElementById('q4_2');
            if (q4_1 && q4_2) {
                const userAnswer1 = q4_1.value.trim().toLowerCase();
                const userAnswer2 = q4_2.value.trim().toLowerCase();
                const correctAnswers_q4 = correctAnswers['q4'].map(a => a.toLowerCase());

                let isCorrect1 = false;
                let isCorrect2 = false;

                if (userAnswer1 && userAnswer2 && userAnswer1 !== userAnswer2) {
                    isCorrect1 = correctAnswers_q4.includes(userAnswer1);
                    isCorrect2 = correctAnswers_q4.includes(userAnswer2);
                } else if (userAnswer1 && !userAnswer2) {
                    isCorrect1 = correctAnswers_q4.includes(userAnswer1);
                } else if (!userAnswer1 && userAnswer2) {
                    isCorrect2 = correctAnswers_q4.includes(userAnswer2);
                }

                if (isCorrect1 && isCorrect2) {
                    q4_1.classList.add('correct');
                    q4_2.classList.add('correct');
                    score++; // Assuming q4 as a whole is 1 point
                } else {
                    q4_1.classList.add('incorrect');
                    q4_2.classList.add('incorrect');
                }
                const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(4)"]`);
                if (btn) {
                    btn.classList.remove('answered');
                    btn.classList.add((isCorrect1 && isCorrect2) ? 'correct' : 'incorrect');
                }
                resultsData.push({
                    question: '4',
                    userAnswer: `${userAnswer1}, ${userAnswer2}`,
                    correctAnswer: correctAnswers['q4'].join(' / '),
                    isCorrect: isCorrect1 && isCorrect2
                });
            }


            Object.keys(correctAnswers).forEach(key => {
                const qNum = parseInt(key.replace('q', ''), 10);
                if (qNum === 4) return; // Skip q4 as it's handled separately

                const correctAnswer = correctAnswers[key];
                let userAnswer = '';
                let isCorrect = false;

                const questionType = questionTypes[key];
                const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);

                switch (questionType) {
                    case 'text':
                        const element = document.getElementById(key);
                        if (element) {
                            userAnswer = element.value.trim();
                            const acceptedAnswers = Array.isArray(correctAnswer) ? correctAnswer : [String(correctAnswer)];
                            isCorrect = acceptedAnswers.some(ans => ans.toLowerCase() === userAnswer.toLowerCase());
                            element.classList.add(isCorrect ? 'correct' : 'incorrect');
                            if (!isCorrect) {
                                const correctAnswerSpan = document.createElement('span');
                                correctAnswerSpan.className = 'correct-answer-text';
                                correctAnswerSpan.textContent = `(Correct: ${acceptedAnswers.join(' / ')})`;
                                element.parentNode.insertBefore(correctAnswerSpan, element.nextSibling);
                            }
                        }
                        break;

                    case 'mcq':
                        const radioChecked = document.querySelector(`input[name="${key}"]:checked`);
                        userAnswer = radioChecked ? radioChecked.value : '';
                        isCorrect = userAnswer === correctAnswer;
                        const isTable = document.querySelector(`input[name="${key}"]`) ? document.querySelector(`input[name="${key}"]`).closest('.mcq-table') : false;

                        if (radioChecked) {
                            if (isTable) {
                                // For table MCQs, mark the row
                                const rowToMark = radioChecked.closest('tr');
                                if (rowToMark) {
                                    rowToMark.classList.add(isCorrect ? 'correct' : 'incorrect');
                                }
                            } else {
                                // For single-choice MCQs, mark the label
                                const labelToMark = radioChecked.closest('label');
                                if (labelToMark) {
                                    labelToMark.classList.add(isCorrect ? 'correct' : 'incorrect');
                                }
                            }
                        }

                        if (!isCorrect) {
                            const correctRadio = document.querySelector(`input[name="${key}"][value="${correctAnswer}"]`);
                            if (correctRadio) {
                                if (isTable) {
                                    // For table MCQs, mark the correct row
                                    const correctRow = correctRadio.closest('tr');
                                    if (correctRow) {
                                        correctRow.classList.add('correct');
                                    }
                                } else {
                                    // For single-choice MCQs, mark the correct label
                                    const correctLabel = correctRadio.closest('label');
                                    if (correctLabel) {
                                        correctLabel.classList.add('correct');
                                    }
                                }
                            }
                        }
                        break;

                    case 'drag_drop':
                        const dropZone = document.querySelector(`.drop-zone[data-question-id="${qNum}"]`);
                        if (dropZone) {
                            const droppedItem = dropZone.querySelector('.drag-item');
                            if (droppedItem) {
                                // Extract just the letter from the text (e.g., "A define a problem" -> "A")
                                const fullText = droppedItem.textContent.trim();
                                userAnswer = fullText.charAt(0); // Get first character which should be the letter
                            } else {
                                userAnswer = '';
                            }
                            isCorrect = userAnswer.toUpperCase() === correctAnswer.toUpperCase();
                            dropZone.classList.add(isCorrect ? 'correct' : 'incorrect');
                            if (!isCorrect) {
                                const correctAnswerSpan = document.createElement('span');
                                correctAnswerSpan.className = 'correct-answer-text';
                                correctAnswerSpan.textContent = `(Correct: ${correctAnswer})`;
                                dropZone.appendChild(correctAnswerSpan);
                            }
                        }
                        break;
                }

                if (isCorrect) score++;

                if (btn) {
                    btn.classList.remove('answered');
                    btn.classList.add(isCorrect ? 'correct' : 'incorrect');
                }

                resultsData.push({
                    question: qNum,
                    userAnswer: userAnswer || 'No Answer',
                    correctAnswer: Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : String(correctAnswer),
                    isCorrect: isCorrect
                });
            });

            const deliverButton = document.getElementById('deliver-button');
            const band = (function (raw) {
                if (raw >= 39) return 9;
                if (raw >= 37) return 8.5;
                if (raw >= 35) return 8;
                if (raw >= 32) return 7.5;
                if (raw >= 30) return 7;
                if (raw >= 26) return 6.5;
                if (raw >= 23) return 6;
                if (raw >= 18) return 5.5;
                if (raw >= 16) return 5;
                if (raw >= 13) return 4.5;
                if (raw >= 10) return 4;
                if (raw >= 8) return 3.5;
                if (raw >= 6) return 3;
                if (raw >= 4) return 2.5;
                if (raw >= 2) return 2;
                if (raw === 1) return 1.5;
                return 0;
            })(score);
            deliverButton.innerHTML = `<span>Score: ${score} / 40 (Band ${band})</span><br><span>Estimated Band: ${band}</span>`;
            deliverButton.disabled = true;
            document.querySelectorAll('.answer-input, input[type="radio"], input[type="checkbox"]').forEach(input => {
                input.disabled = true;
            });
            document.querySelectorAll('.drag-item').forEach(item => {
                item.setAttribute('draggable', 'false');
                item.style.cursor = 'default';
            });
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.remove('drag-over'); // Ensure no lingering hover styles
            });

            document.querySelector('.main-container').classList.add('results-mode');
            switchToPart(currentPart); // Show the transcription for the current part

            // Populate and show modal
            const modal = document.getElementById('result-modal');
            const scoreSummary = document.getElementById('score-summary');
            const resultDetails = document.getElementById('result-details');

            scoreSummary.textContent = `You scored ${score} out of 40 (Band ${band}).`;

            let tableHTML = '<table><tr><th>Question</th><th>Your Answer</th><th>Correct Answer</th><th>Result</th></tr>';
            resultsData.sort((a, b) => parseInt(a.question, 10) - parseInt(b.question, 10)).forEach(res => {
                tableHTML += `
                    <tr>
                        <td>${res.question}</td>
                        <td>${res.userAnswer}</td>
                        <td>${res.correctAnswer}</td>
                        <td class="${res.isCorrect ? 'result-correct' : 'result-incorrect'}">
                            ${res.isCorrect ? '✔ Correct' : '✖ Incorrect'}
                        </td>
                    </tr>
                `;
            });
            tableHTML += '</table>';
            resultDetails.innerHTML = tableHTML;

            modal.style.display = 'flex';
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeInSeconds--;
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                timerDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                if (timeInSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "Time's up!";
                    checkAnswers();
                }
            }, 1000);
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
        }

        // Event Listeners
        playPauseBtn.addEventListener('click', () => {
            if (!testStarted) {
                testStarted = true; // Timer removed, skip startTimer
                switchToPart(currentPart, true);
            } else {
                if (audioPlayer.paused) {
                    // If paused, ensure the audio source is for the current part
                    if (!audioPlayer.src.includes(audioSource)) {
                        audioPlayer.src = audioSource;
                    }
                    audioPlayer.play();
                } else {
                    audioPlayer.pause();
                }
            }
        });

        audioPlayer.addEventListener('play', () => {
            playPauseBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>`;
        });

        audioPlayer.addEventListener('pause', () => {
            playPauseBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>`;
        });

        audioPlayer.addEventListener('ended', () => {
            if (currentPart < 4) {
                switchToPart(currentPart + 1, true);
            }
        });

        audioPlayer.addEventListener('loadedmetadata', () => {
            progressBar.max = audioPlayer.duration;
            totalDurationEl.textContent = formatTime(audioPlayer.duration);
        });

        audioPlayer.addEventListener('timeupdate', () => {
            progressBar.value = audioPlayer.currentTime;
            currentTimeEl.textContent = formatTime(audioPlayer.currentTime);
        });

        progressBar.addEventListener('input', () => {
            audioPlayer.currentTime = progressBar.value;
        });

        volumeSlider.addEventListener('input', (e) => audioPlayer.volume = e.target.value);

        speedBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            speedOptions.classList.toggle('hidden');
        });

        speedOptions.addEventListener('click', (e) => {
            if (e.target.dataset.speed) {
                const speed = parseFloat(e.target.dataset.speed);
                audioPlayer.playbackRate = speed;
                speedBtn.textContent = `${speed}x`;
                speedOptions.classList.add('hidden');
            }
        });

        document.addEventListener('click', () => {
            if (!speedOptions.classList.contains('hidden')) {
                speedOptions.classList.add('hidden');
            }
        });

        document.getElementById('deliver-button').addEventListener('click', checkAnswers);

        // Go To Question Widget Logic
        const gotoWidget = document.getElementById('goto-widget');
        const gotoInput = document.getElementById('goto-input');
        const gotoBtn = document.getElementById('goto-btn');

        document.addEventListener('keydown', (e) => {
            if (e.key >= '0' && e.key <= '9' && document.activeElement.tagName !== 'INPUT') {
                e.preventDefault();
                gotoWidget.classList.remove('hidden');
                gotoInput.focus();
                gotoInput.value = e.key;
            }
            if (e.key === 'Enter' && document.activeElement === gotoInput) {
                gotoBtn.click();
            }
            if (e.key === 'Escape') {
                gotoWidget.classList.add('hidden');
                gotoInput.value = '';
            }
        });

        if (gotoBtn) {
            gotoBtn.addEventListener('click', () => {
                const qNum = parseInt(gotoInput.value, 10);
                if (qNum >= 1 && qNum <= 40) {
                    goToQuestion(qNum);
                    gotoWidget.classList.add('hidden');
                    gotoInput.value = '';
                } else {
                    alert('Please enter a number between 1 and 40.');
                }
            });
        }

        // Add listener for the modal close button
        document.getElementById('modal-close-button').addEventListener('click', () => {
            document.getElementById('result-modal').style.display = 'none';
        });

        // === Tap-to-select & tap-to-drop for drag items (mobile support) ===
        document.body.addEventListener('click', function (e) {
            const item = e.target.closest('.drag-item');
            if (item && item.getAttribute('draggable')) {
                // Toggle selection
                document.querySelectorAll('.drag-item.selected').forEach(i => i.classList.remove('selected'));
                item.classList.add('selected');
                draggedElement = item;
                return;
            }
            const dz = e.target.closest('.drop-zone');
            if (dz && draggedElement) {
                // If already filled, move old back
                const optionsList = document.querySelector('.matching-options-list');
                if (dz.children.length > 0 && dz.firstElementChild !== draggedElement) {
                    optionsList.appendChild(dz.firstElementChild);
                }
                dz.appendChild(draggedElement);
                draggedElement.classList.remove('selected');
                draggedElement = null;
                updateAnsweredIndicators();
            }
        });

        // === Mobile highlight/comment toolbar ===
        const mobileToolbar = document.getElementById('mobile-selection-menu');
        function positionToolbar() {
            const sel = window.getSelection();
            if (sel.rangeCount === 0 || sel.isCollapsed) {
                mobileToolbar.classList.add('hidden');
                return;
            }
            const range = sel.getRangeAt(0);
            const rect = range.getBoundingClientRect();
            mobileToolbar.style.top = window.scrollY + rect.top - mobileToolbar.offsetHeight - 8 + 'px';
            mobileToolbar.style.left = window.scrollX + rect.left + 'px';
            mobileToolbar.classList.remove('hidden');
        }
        document.addEventListener('selectionchange', () => {
            const sel = window.getSelection();
            if (sel && sel.rangeCount > 0 && !sel.isCollapsed) {
                selectedRange = sel.getRangeAt(0);
                selectedText = sel.toString();
            }
            if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
                setTimeout(positionToolbar, 0);
            }
        });
        document.addEventListener('click', (e) => {
            if (!e.target.closest('#mobile-selection-menu')) {
                mobileToolbar.classList.add('hidden');
            }
        });

        /* ---------------- Drag and Drop for Matching Questions ---------------- */

        (function initDragAndDrop() {
            const container = document.querySelector('.left-panel');
            if (!container) return;

            container.addEventListener('dragstart', (e) => {
                if (e.target.classList.contains('drag-item')) {
                    draggedElement = e.target;
                    setTimeout(() => {
                        e.target.classList.add('dragging');
                    }, 0);
                }
            });

            container.addEventListener('dragend', (e) => {
                if (draggedElement) {
                    draggedElement.classList.remove('dragging');
                    draggedElement = null;
                }
            });

            container.addEventListener('dragover', (e) => {
                e.preventDefault();
                const target = e.target;
                const dropZone = target.closest('.drop-zone');
                const optionsList = target.closest('.matching-options-list');

                if (dropZone || optionsList) {
                    const overElement = dropZone || optionsList;
                    document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
                    overElement.classList.add('drag-over');
                }
            });

            container.addEventListener('dragleave', (e) => {
                const target = e.target;
                const dropZone = target.closest('.drop-zone');
                const optionsList = target.closest('.matching-options-list');
                if (dropZone || optionsList) {
                    const overElement = dropZone || optionsList;
                    overElement.classList.remove('drag-over');
                }
            });


            container.addEventListener('drop', (e) => {
                e.preventDefault();
                if (!draggedElement) return;

                const dropTarget = e.target.closest('.drop-zone, .matching-options-list');
                if (!dropTarget) {
                    draggedElement.classList.remove('dragging');
                    draggedElement = null;
                    return;
                }

                document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));

                const existingItem = dropTarget.matches('.drop-zone') ? dropTarget.querySelector('.drag-item') : null;
                const originalParent = draggedElement.parentNode;

                // If there's an item in the target dropzone, swap them
                if (existingItem) {
                    originalParent.appendChild(existingItem);
                }

                dropTarget.appendChild(draggedElement);

                if (dropTarget.matches('.drop-zone')) {
                    const placeholder = dropTarget.querySelector('.placeholder');
                    if (placeholder) placeholder.style.display = 'none';
                }

                draggedElement.classList.remove('dragging');
                draggedElement = null;
                updateAnsweredIndicators();
            });
        })();


        document.addEventListener('DOMContentLoaded', () => {
            switchToPart(1);
            goToQuestion(1);
            setupCheckboxLimits();

            document.body.addEventListener('contextmenu', function (e) {
                const text = window.getSelection().toString();
                if (!text) return;
                e.preventDefault();
                const menu = document.getElementById('contextMenu');
                menu.style.left = e.pageX + 'px';
                menu.style.top = e.pageY + 'px';
                menu.style.display = 'block';

                const target = e.target;
                const clearItem = document.getElementById('clear-item');
                contextElement = target.closest('.highlight, .comment-highlight');
                if (contextElement) {
                    clearItem.style.display = 'block';
                } else {
                    clearItem.style.display = 'none';
                }
            });

            document.body.addEventListener('click', function (e) {
                if (e.target.closest('.context-menu')) return;
                document.getElementById('contextMenu').style.display = 'none';
            });
        });

        // Initial setup on DOM load
        document.addEventListener('DOMContentLoaded', updateAnsweredIndicators);

        document.querySelectorAll('.mcq-table td').forEach(cell => {
            cell.addEventListener('click', (e) => {
                if (e.target.tagName !== 'INPUT') {
                    const radio = cell.querySelector('input[type="radio"]');
                    if (radio && !radio.disabled) {
                        radio.checked = true;
                    }
                }
            });
        });

        document.querySelectorAll('.answer-input, input[type="radio"], input[type="checkbox"]').forEach(input => {
            input.addEventListener('input', updateAnsweredIndicators);
            input.addEventListener('change', updateAnsweredIndicators);
        });

        function initAllDragAndDrop() {
            const dragItems = document.querySelectorAll('.drag-item');
            const dropZones = document.querySelectorAll('.drop-zone');

            dragItems.forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
            });

            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });

            function handleDragStart(e) {
                draggedElement = e.target;
                setTimeout(() => e.target.classList.add('dragging'), 0);
            }

            function handleDragEnd(e) {
                e.target.classList.remove('dragging');
            }

            function handleDragOver(e) {
                e.preventDefault();
                const zone = e.target.closest('.drop-zone');
                if (zone) zone.classList.add('drag-over');
            }

            function handleDragLeave(e) {
                const zone = e.target.closest('.drop-zone');
                if (zone) zone.classList.remove('drag-over');
            }

            function handleDrop(e) {
                e.preventDefault();
                const targetZone = e.target.closest('.drop-zone');
                if (!targetZone || !draggedElement) return;

                targetZone.classList.remove('drag-over');

                const sourceContainer = draggedElement.parentNode;
                const itemInTargetZone = targetZone.querySelector('.drag-item');

                // Prevent dropping on self or non-droppable area inside zone
                if (e.target.classList.contains('drag-item') && e.target !== draggedElement) {
                    return; // Or handle swap explicitly here if needed
                }

                if (itemInTargetZone && itemInTargetZone !== draggedElement) {
                    // If source is an options list, move the existing item back
                    const optionsList = findParentOptionsList(targetZone);
                    if (sourceContainer.classList.contains('matching-options-list') || sourceContainer.classList.contains('map-options-list')) {
                        optionsList.appendChild(itemInTargetZone);
                    }
                    // If source is another drop zone (swapping)
                    else if (sourceContainer.classList.contains('drop-zone')) {
                        sourceContainer.appendChild(itemInTargetZone);
                    }
                }

                targetZone.appendChild(draggedElement);
                if (targetZone.querySelector('.placeholder')) {
                    targetZone.querySelector('.placeholder').style.display = 'none';
                }

                updateAnsweredIndicators();
            }

            function findParentOptionsList(element) {
                // Specific for map
                if (element.closest('#map-drag-container')) {
                    return document.getElementById('map-options-q11-15');
                }
                // Generic for matching
                const container = element.closest('.matching-container');
                if (container) {
                    return container.querySelector('.matching-options-list');
                }
                return null;
            }
        }

        let transcriptionHighlighted = false;
        function highlightAnswersInTranscription() {
            if (transcriptionHighlighted) return;

            const highlightedTranscripts = { 1: '', 2: '', 3: '', 4: '' };

            for (let i = 1; i <= 4; i++) {
                const partElement = document.querySelector(`#transcription-data [data-part="${i}"]`);
                if (partElement) highlightedTranscripts[i] = partElement.innerHTML;
            }

            for (const key in correctAnswers) {
                const answers = Array.isArray(correctAnswers[key]) ? correctAnswers[key] : [correctAnswers[key]];
                if (answers.every(answer => /^[A-G]$/.test(answer))) {
                    continue;
                }

                const qNum = parseInt(key.match(/\d+/)[0]);
                let partNumber = 1;
                if (qNum > 10 && qNum <= 20) partNumber = 2;
                else if (qNum > 20 && qNum <= 30) partNumber = 3;
                else if (qNum > 30) partNumber = 4;

                if (!highlightedTranscripts[partNumber]) continue;

                let answersToHighlight = correctAnswers[key];
                if (!Array.isArray(answersToHighlight)) {
                    answersToHighlight = [answersToHighlight];
                }

                for (const answer of answersToHighlight) {
                    if (/^[A-G]$/.test(answer)) continue;

                    let searchTerm = answer.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
                    searchTerm = searchTerm.replace(/\\\(s\\\)/g, '(s)?');

                    const regex = new RegExp(`\\b(${searchTerm})\\b`, 'gi');

                    highlightedTranscripts[partNumber] = highlightedTranscripts[partNumber].replace(
                        regex,
                        '<span class="highlight">$1</span>'
                    );
                }
            }

            for (let i = 1; i <= 4; i++) {
                const partElement = document.querySelector(`#transcription-data [data-part="${i}"]`);
                if (partElement) partElement.innerHTML = highlightedTranscripts[i];
            }
            transcriptionHighlighted = true;
        }

        function closeContextMenu() {
            document.getElementById('contextMenu').style.display = 'none';
            contextElement = null;
        }


        (function () {
            // Wait for DOM just in case script is loaded early
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }

            function init() {
                const timerEl = document.getElementById('timer');
                const startBtn = document.getElementById('start-timer');
                const pauseBtn = document.getElementById('pause-timer');
                const resetBtn = document.getElementById('reset-timer');

                if (!timerEl) {
                    console.warn('Timer element #timer not found. Timer script aborted.');
                    return;
                }

                // Use an existing global time if a number is present, otherwise default to 60 minutes
                const DEFAULT_SECONDS = 40 * 60;
                let time = (typeof window.timeInSeconds === 'number') ? Math.floor(window.timeInSeconds) : DEFAULT_SECONDS;
                let intervalId = null;

                const fmt = (sec) => {
                    const m = Math.floor(sec / 60);
                    const s = sec % 60;
                    return String(m).padStart(2, '0') + ':' + String(s).padStart(2, '0');
                };

                function render() {
                    timerEl.textContent = fmt(time);
                    // keep global in sync if other parts of the page expect it
                    if (typeof window.timeInSeconds === 'number') window.timeInSeconds = time;
                }

                function start() {
                    if (intervalId) return; // already running
                    intervalId = setInterval(() => {
                        if (time > 0) {
                            time -= 1;
                            render();
                        } else {
                            clearInterval(intervalId);
                            intervalId = null;
                        }
                    }, 1000);
                }

                function pause() {
                    if (intervalId) {
                        clearInterval(intervalId);
                        intervalId = null;
                    }
                }

                function reset() {
                    pause();
                    time = DEFAULT_SECONDS;
                    render();
                }

                // Hook buttons if present
                if (startBtn) startBtn.addEventListener('click', start);
                if (pauseBtn) pauseBtn.addEventListener('click', pause);
                if (resetBtn) resetBtn.addEventListener('click', reset);

                // initial render
                render();

                // Expose debug handle to console: window._umarTimer
                window._umarTimer = {
                    start, pause, reset, render,
                    get time() { return time; },
                    set time(v) {
                        const n = Number(v);
                        if (!Number.isNaN(n) && n >= 0) {
                            time = Math.floor(n);
                            render();
                        } else {
                            console.warn('Invalid time set on window._umarTimer.time');
                        }
                    }
                };
            }
        })();
    </script>
</body>

</html>